// cards.js
export const deck = [
  { color: "Blue", value: "0", id: 1, url: "Blue_0.png" },
  { color: "Blue", value: "1", id: 2, url: "Blue_1.png" },
  { color: "Blue", value: "2", id: 3, url: "Blue_2.png" },
  { color: "Blue", value: "3", id: 4, url: "Blue_3.png" },
  { color: "Blue", value: "4", id: 5, url: "Blue_4.png" },
  { color: "Blue", value: "5", id: 6, url: "Blue_5.png" },
  { color: "Blue", value: "6", id: 7, url: "Blue_6.png" },
  { color: "Blue", value: "7", id: 8, url: "Blue_7.png" },
  { color: "Blue", value: "8", id: 9, url: "Blue_8.png" },
  { color: "Blue", value: "9", id: 10, url: "Blue_9.png" },
  { color: "Blue", value: "Draw", id: 11, url: "Blue_Draw.png" },
  { color: "Blue", value: "Reverse", id: 12, url: "Blue_Reverse.png" },
  { color: "Blue", value: "Skip", id: 13, url: "Blue_Skip.png" },
  { color: "Blue", value: "0", id: 14, url: "Blue_0.png" },
  { color: "Blue", value: "1", id: 15, url: "Blue_1.png" },
  { color: "Blue", value: "2", id: 16, url: "Blue_2.png" },
  { color: "Blue", value: "3", id: 17, url: "Blue_3.png" },
  { color: "Blue", value: "4", id: 18, url: "Blue_4.png" },
  { color: "Blue", value: "5", id: 19, url: "Blue_5.png" },
  { color: "Blue", value: "6", id: 20, url: "Blue_6.png" },
  { color: "Blue", value: "7", id: 21, url: "Blue_7.png" },
  { color: "Blue", value: "8", id: 22, url: "Blue_8.png" },
  { color: "Blue", value: "9", id: 23, url: "Blue_9.png" },
  { color: "Blue", value: "Draw", id: 24, url: "Blue_Draw.png" },
  { color: "Blue", value: "Reverse", id: 25, url: "Blue_Reverse.png" },
  { color: "Blue", value: "Skip", id: 26, url: "Blue_Skip.png" },

  // Kartu hijau
  { color: "Green", value: "0", id: 27, url: "Green_0.png" },
  { color: "Green", value: "1", id: 28, url: "Green_1.png" },
  { color: "Green", value: "2", id: 29, url: "Green_2.png" },
  { color: "Green", value: "3", id: 30, url: "Green_3.png" },
  { color: "Green", value: "4", id: 31, url: "Green_4.png" },
  { color: "Green", value: "5", id: 32, url: "Green_5.png" },
  { color: "Green", value: "6", id: 33, url: "Green_6.png" },
  { color: "Green", value: "7", id: 34, url: "Green_7.png" },
  { color: "Green", value: "8", id: 35, url: "Green_8.png" },
  { color: "Green", value: "9", id: 36, url: "Green_9.png" },
  { color: "Green", value: "Draw", id: 37, url: "Green_Draw.png" },
  { color: "Green", value: "Reverse", id: 38, url: "Green_Reverse.png" },
  { color: "Green", value: "Skip", id: 39, url: "Green_Skip.png" },
  { color: "Green", value: "0", id: 40, url: "Green_0.png" },
  { color: "Green", value: "1", id: 41, url: "Green_1.png" },
  { color: "Green", value: "2", id: 42, url: "Green_2.png" },
  { color: "Green", value: "3", id: 43, url: "Green_3.png" },
  { color: "Green", value: "4", id: 44, url: "Green_4.png" },
  { color: "Green", value: "5", id: 45, url: "Green_5.png" },
  { color: "Green", value: "6", id: 46, url: "Green_6.png" },
  { color: "Green", value: "7", id: 47, url: "Green_7.png" },
  { color: "Green", value: "8", id: 48, url: "Green_8.png" },
  { color: "Green", value: "9", id: 49, url: "Green_9.png" },
  { color: "Green", value: "Draw", id: 50, url: "Green_Draw.png" },
  { color: "Green", value: "Reverse", id: 51, url: "Green_Reverse.png" },
  { color: "Green", value: "Skip", id: 52, url: "Green_Skip.png" },

  // Kartu merah
  { color: "Red", value: "0", id: 53, url: "Red_0.png" },
  { color: "Red", value: "1", id: 54, url: "Red_1.png" },
  { color: "Red", value: "2", id: 55, url: "Red_2.png" },
  { color: "Red", value: "3", id: 56, url: "Red_3.png" },
  { color: "Red", value: "4", id: 57, url: "Red_4.png" },
  { color: "Red", value: "5", id: 58, url: "Red_5.png" },
  { color: "Red", value: "6", id: 59, url: "Red_6.png" },
  { color: "Red", value: "7", id: 60, url: "Red_7.png" },
  { color: "Red", value: "8", id: 61, url: "Red_8.png" },
  { color: "Red", value: "9", id: 62, url: "Red_9.png" },
  { color: "Red", value: "Draw", id: 63, url: "Red_Draw.png" },
  { color: "Red", value: "Reverse", id: 64, url: "Red_Reverse.png" },
  { color: "Red", value: "Skip", id: 65, url: "Red_Skip.png" },
  { color: "Red", value: "0", id: 66, url: "Red_0.png" },
  { color: "Red", value: "1", id: 67, url: "Red_1.png" },
  { color: "Red", value: "2", id: 68, url: "Red_2.png" },
  { color: "Red", value: "3", id: 69, url: "Red_3.png" },
  { color: "Red", value: "4", id: 70, url: "Red_4.png" },
  { color: "Red", value: "5", id: 71, url: "Red_5.png" },
  { color: "Red", value: "6", id: 72, url: "Red_6.png" },
  { color: "Red", value: "7", id: 73, url: "Red_7.png" },
  { color: "Red", value: "8", id: 74, url: "Red_8.png" },
  { color: "Red", value: "9", id: 75, url: "Red_9.png" },
  { color: "Red", value: "Draw", id: 76, url: "Red_Draw.png" },
  { color: "Red", value: "Reverse", id: 77, url: "Red_Reverse.png" },
  { color: "Red", value: "Skip", id: 78, url: "Red_Skip.png" },

  // Kartu kuning
  { color: "Yellow", value: "0", id: 79, url: "Yellow_0.png" },
  { color: "Yellow", value: "1", id: 80, url: "Yellow_1.png" },
  { color: "Yellow", value: "2", id: 81, url: "Yellow_2.png" },
  { color: "Yellow", value: "3", id: 82, url: "Yellow_3.png" },
  { color: "Yellow", value: "4", id: 83, url: "Yellow_4.png" },
  { color: "Yellow", value: "5", id: 84, url: "Yellow_5.png" },
  { color: "Yellow", value: "6", id: 85, url: "Yellow_6.png" },
  { color: "Yellow", value: "7", id: 86, url: "Yellow_7.png" },
  { color: "Yellow", value: "8", id: 87, url: "Yellow_8.png" },
  { color: "Yellow", value: "9", id: 88, url: "Yellow_9.png" },
  { color: "Yellow", value: "Draw", id: 89, url: "Yellow_Draw.png" },
  { color: "Yellow", value: "Reverse", id: 90, url: "Yellow_Reverse.png" },
  { color: "Yellow", value: "Skip", id: 91, url: "Yellow_Skip.png" },
  { color: "Yellow", value: "0", id: 92, url: "Yellow_0.png" },
  { color: "Yellow", value: "1", id: 93, url: "Yellow_1.png" },
  { color: "Yellow", value: "2", id: 94, url: "Yellow_2.png" },
  { color: "Yellow", value: "3", id: 95, url: "Yellow_3.png" },
  { color: "Yellow", value: "4", id: 96, url: "Yellow_4.png" },
  { color: "Yellow", value: "5", id: 97, url: "Yellow_5.png" },
  { color: "Yellow", value: "6", id: 98, url: "Yellow_6.png" },
  { color: "Yellow", value: "7", id: 99, url: "Yellow_7.png" },
  { color: "Yellow", value: "8", id: 100, url: "Yellow_8.png" },
  { color: "Yellow", value: "9", id: 101, url: "Yellow_9.png" },
  { color: "Yellow", value: "Draw", id: 102, url: "Yellow_Draw.png" },
  { color: "Yellow", value: "Reverse", id: 103, url: "Yellow_Reverse.png" },
  { color: "Yellow", value: "Skip", id: 104, url: "Yellow_Skip.png" },

  // Kartu Wild
  { color: "Wild", value: "Wild", id: 105, url: "Wild_Wild.png" },
  { color: "Wild", value: "Wild", id: 106, url: "Wild_Wild.png" },
  { color: "Wild", value: "Wild", id: 107, url: "Wild_Wild.png" },
  { color: "Wild", value: "Wild", id: 108, url: "Wild_Wild.png" },
  { color: "Wild", value: "Draw4", id: 109, url: "Wild_Draw4.png" },
  { color: "Wild", value: "Draw4", id: 110, url: "Wild_Draw4.png" },
  { color: "Wild", value: "Draw4", id: 111, url: "Wild_Draw4.png" },
  { color: "Wild", value: "Draw4", id: 112, url: "Wild_Draw4.png" },
];

export const specialActionCards = [
  { color: "Blue", value: "Draw", id: 11, url: "Blue_Draw.png" },
  { color: "Blue", value: "Reverse", id: 12, url: "Blue_Reverse.png" },
  { color: "Blue", value: "Skip", id: 13, url: "Blue_Skip.png" },
  { color: "Blue", value: "Draw", id: 24, url: "Blue_Draw.png" },
  { color: "Blue", value: "Reverse", id: 25, url: "Blue_Reverse.png" },
  { color: "Blue", value: "Skip", id: 26, url: "Blue_Skip.png" },
  { color: "Green", value: "Draw", id: 37, url: "Green_Draw.png" },
  { color: "Green", value: "Reverse", id: 38, url: "Green_Reverse.png" },
  { color: "Green", value: "Skip", id: 39, url: "Green_Skip.png" },
  { color: "Green", value: "Draw", id: 50, url: "Green_Draw.png" },
  { color: "Green", value: "Reverse", id: 51, url: "Green_Reverse.png" },
  { color: "Green", value: "Skip", id: 52, url: "Green_Skip.png" },
  { color: "Red", value: "Draw", id: 63, url: "Red_Draw.png" },
  { color: "Red", value: "Reverse", id: 64, url: "Red_Reverse.png" },
  { color: "Red", value: "Skip", id: 65, url: "Red_Skip.png" },
  { color: "Red", value: "Draw", id: 76, url: "Red_Draw.png" },
  { color: "Red", value: "Reverse", id: 77, url: "Red_Reverse.png" },
  { color: "Red", value: "Skip", id: 78, url: "Red_Skip.png" },
  { color: "Yellow", value: "Draw", id: 89, url: "Yellow_Draw.png" },
  { color: "Yellow", value: "Reverse", id: 90, url: "Yellow_Reverse.png" },
  { color: "Yellow", value: "Skip", id: 91, url: "Yellow_Skip.png" },
  { color: "Yellow", value: "Draw", id: 102, url: "Yellow_Draw.png" },
  { color: "Yellow", value: "Reverse", id: 103, url: "Yellow_Reverse.png" },
  { color: "Yellow", value: "Skip", id: 104, url: "Yellow_Skip.png" },
  { color: "Wild", value: "Wild", id: 105, url: "Wild_Wild.png" },
  { color: "Wild", value: "Wild", id: 106, url: "Wild_Wild.png" },
  { color: "Wild", value: "Wild", id: 107, url: "Wild_Wild.png" },
  { color: "Wild", value: "Wild", id: 108, url: "Wild_Wild.png" },
  { color: "Wild", value: "Draw4", id: 109, url: "Wild_Draw4.png" },
  { color: "Wild", value: "Draw4", id: 110, url: "Wild_Draw4.png" },
  { color: "Wild", value: "Draw4", id: 111, url: "Wild_Draw4.png" },
  { color: "Wild", value: "Draw4", id: 112, url: "Wild_Draw4.png" }
];

export const cards = deck.map((item, index) => ({
  color: item.color,
  value: item.value,
  id: item.id,
  url: item.url,
}));

// Fungsi untuk menarik kartu dari deck
export function drawCardsFromDeck(deck, numCards) {
  if (numCards > deck.length) {
      throw new Error("Not enough cards in the deck.");
  }

  const drawnCards = deck.slice(0, numCards);
  deck.splice(0, numCards);

  return drawnCards;
}

// Fungsi untuk membuat dan mengacak deck
export function createAndShuffleDeck() {
  const shuffledDeck = [...deck];
  for (let i = shuffledDeck.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [shuffledDeck[i], shuffledDeck[j]] = [shuffledDeck[j], shuffledDeck[i]];
  }

  return shuffledDeck;
}

// Fungsi untuk menghapus kartu dari tangan pemain
export function removeCardFromHand(hand, card) {
  const index = hand.findIndex(handCard => handCard.id === card.id);

  if (index !== -1) {
      hand.splice(index, 1);
  }
}

// Fungsi untuk menentukan apakah kartu dapat diletakkan
export function canPlaceCard(card, lastPlayedCard) {

  if (card.color === lastPlayedCard.color || card.value === lastPlayedCard.value) {
      return true;
  } else if (card.color === "Wild" || lastPlayedCard.color === "Wild") {
      return true;
  } else if (isSpecialActionCard(card)) {
    return true;
  }

  return false;
}

export function performSpecialAction(card, currentTurn, players) {

  switch (card.value) {
    case "Reverse":
      return {
        newTurn: currentTurn.reverse(),
        drawCards: 0,
      };
    case "Skip":
      return {
        newTurn: (currentTurn + 2) % players.length,
        drawCards: 0,
      };
    case "Draw2":
      return {
        newTurn: (currentTurn + 1) % players.length,
        drawCards: 2,
      };
    case "Wild":
    case "WildDraw4":
      return {
        newTurn: currentTurn,
        drawCards: card.value === "Wild" ? 0 : 4,
      };
    default:
      return {
        newTurn: currentTurn,
        drawCards: 0,
      };
  }
}

// Helper function untuk menentukan apakah suatu kartu adalah kartu aksi khusus
function isSpecialActionCard(card) {
  const specialActions = ["Reverse", "Skip", "Draw2", "Wild", "WildDraw4"];
  return specialActions.includes(card.value);
}
